<Window x:Class="QuanLyNhaHang.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        
        xmlns:vm="clr-namespace:QuanLyNhaHang.ViewModel"
        xmlns:view="clr-namespace:QuanLyNhaHang.View"
        
        mc:Ignorable="d"
        Title="Phần mềm Quản lý Nhà hàng" Height="720" Width="1280"
        WindowStartupLocation="CenterScreen"
        Name="mainWindow"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="14"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <!-- 1. KẾT NỐI VIEWMODEL -->
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- 2. BẢN ĐỒ ĐIỀU HƯỚNG -->

        <DataTemplate DataType="{x:Type vm:HomeViewModel}">
            <view:HomeView/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:TableViewModel}">
            <view:TableControl/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:FoodManagementViewModel}">
            <view:FoodManagementView/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:StaffViewModel}">
            <view:StaffView/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:ReportViewModel}">
            <view:ReportView/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:PromotionViewModel}">
            <view:PromotionView/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:AccountViewModel}">
            <view:AccountView/>
        </DataTemplate>

        <!-- MỚI THÊM: Template cho màn hình Khách hàng -->
        <DataTemplate DataType="{x:Type vm:CustomerOrderViewModel}">
            <view:CustomerOrderView/>
        </DataTemplate>

        <!-- 3. STYLE CHO MENU BUTTON -->
        <Style x:Key="MenuButtonStyle" TargetType="RadioButton">
            <Setter Property="Height" Value="50"/>
            <Setter Property="Margin" Value="10,5"/>
            <Setter Property="Foreground" Value="#DDFFFFFF"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" CornerRadius="10" Background="Transparent" Padding="15,0">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="{Binding Tag, RelativeSource={RelativeSource TemplatedParent}}" 
                                                         Width="24" Height="24" VerticalAlignment="Center"/>
                                <ContentPresenter VerticalAlignment="Center" Margin="15,0,0,0"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="#673AB7"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#33FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- 4. BỐ CỤC CHÍNH -->
    <Grid Background="#F0F2F5">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- === MENU BÊN TRÁI === -->
        <Grid Grid.Column="0">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#512DA8" Offset="0.0"/>
                    <GradientStop Color="#311B92" Offset="1.0"/>
                </LinearGradientBrush>
            </Grid.Background>

            <DockPanel>
                <!-- Logo -->
                <StackPanel DockPanel.Dock="Top" Margin="0,30,0,20">
                    <materialDesign:PackIcon Kind="ChefHat" Width="60" Height="60" 
                                             Foreground="White" HorizontalAlignment="Center"/>
                    <TextBlock Text="RESTAURANT" Foreground="White" FontWeight="Bold" 
                               FontSize="22" HorizontalAlignment="Center" Margin="0,10,0,0"/>
                    <TextBlock Text="MANAGER" Foreground="#AAFFFFFF" FontSize="12" HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Nút Đăng Xuất -->
                <Button DockPanel.Dock="Bottom" Margin="20,20,20,30" Height="45"
                        Command="{Binding LogOutCommand}"
                        CommandParameter="{Binding ElementName=mainWindow}"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        Foreground="White" BorderBrush="White" Content="Đăng xuất">
                    <Button.ContentTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Logout" Margin="0,0,10,0"/>
                                <TextBlock Text="Đăng xuất"/>
                            </StackPanel>
                        </DataTemplate>
                    </Button.ContentTemplate>
                </Button>

                <!-- Danh sách Menu -->
                <StackPanel DockPanel.Dock="Top">

                    <!-- 1. CÁC NÚT NỘI BỘ (Admin + Staff thấy) -->
                    <!-- Dùng InternalVisibility để ẩn với Khách hàng -->
                    <RadioButton Content="Trang chủ" Tag="Home"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding HomeViewCommand}" 
                                 Visibility="{Binding InternalVisibility}"
                                 IsChecked="True"/>

                    <RadioButton Content="Quản lý Bàn" Tag="TableFurniture"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding TableViewCommand}"
                                 Visibility="{Binding InternalVisibility}"/>

                    <!-- 2. CÁC NÚT QUẢN TRỊ (Chỉ Admin thấy) -->
                    <RadioButton Content="Thực đơn" Tag="FoodForkDrink"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding FoodViewCommand}"
                                 Visibility="{Binding AdminVisibility}"/>

                    <RadioButton Content="Nhân viên" Tag="AccountGroup"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding StaffViewCommand}"
                                 Visibility="{Binding AdminVisibility}"/>

                    <RadioButton Content="Thống kê" Tag="ChartBar"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding ReportViewCommand}"
                                 Visibility="{Binding AdminVisibility}"/>

                    <RadioButton Content="Khuyến mãi" Tag="TicketPercent"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding PromotionViewCommand}"
                                 Visibility="{Binding AdminVisibility}"/>

                    <!-- 3. NÚT DÀNH CHO KHÁCH (Chỉ Khách thấy) -->
                    <RadioButton Content="Gọi Món" Tag="SilverwareVariant"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding CustomerOrderViewCommand}"
                                 Visibility="{Binding CustomerVisibility}"/>

                    <!-- 4. Nút Tài khoản (Ai cũng thấy) -->
                    <RadioButton Content="Tài khoản" Tag="AccountCog"
                                 Style="{StaticResource MenuButtonStyle}"
                                 Command="{Binding AccountViewCommand}"/>
                </StackPanel>
            </DockPanel>
        </Grid>

        <!-- === NỘI DUNG BÊN PHẢI === -->
        <Grid Grid.Column="1" Margin="20">
            <Border Background="White" CornerRadius="15" Effect="{DynamicResource MaterialDesignShadowDepth1}">
                <ContentControl Content="{Binding CurrentView}" Margin="10" ClipToBounds="True"/>
            </Border>
        </Grid>
    </Grid>
</Window>